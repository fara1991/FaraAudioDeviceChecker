# FaraDeviceChecker

Windowsのオーディオデバイスとドライバーの状態を診断するツールです。

## ダウンロード

[最新リリース](https://github.com/fara1991/FaraDeviceChecker/releases)から以下をダウンロードしてください：

- **FaraDeviceChecker-vX.X.X-win-x64.zip** (推奨)

## インストール

インストールは不要です。

1. ダウンロードしたZIPファイルを解凍
2. 任意のフォルダに配置
3. すぐに使用可能

## 使い方

### 基本的な実行方法

**方法1: ダブルクリックで実行**
- `FaraDeviceChecker.exe` をダブルクリック

**方法2: コマンドプロンプトから実行**
```cmd
FaraDeviceChecker.exe
```

**方法3: PowerShellから実行**
```powershell
.\FaraDeviceChecker.exe
```

### 実行例

プログラムを起動すると以下のように表示されます：

```
=== Audioドライバー状態チェッカー ===

検出されたAudioデバイス数: 8

デバイス名: Realtek High Definition Audio
製造元: Realtek
デバイスID: HDAUDIO\FUNC_01&VEN_10EC&DEV_0887...
ドライバーバージョン: 6.0.9374.1
ドライバー日付: 2023/08/15
ステータス: OK
クラス: Media
サービス: IntcAzAudAddService

✅ 正常に動作しています

================================================================================
```

## 結果の見方

### デバイス状態の表示

各デバイスについて以下の状態が表示されます：

**正常な場合**
- ✅ 緑色の文字で「正常に動作しています」

**注意が必要な場合**
- ⚠️ 黄色の文字で問題点を表示
- 例：「ドライバーが古い可能性があります」

**エラーがある場合**
- 問題の詳細が表示されます
- 例：「ドライバー情報が取得できませんでした」

### 表示される情報

| 項目 | 説明 |
|------|------|
| デバイス名 | オーディオデバイスの名前 |
| 製造元 | デバイスのメーカー |
| ドライバーバージョン | 現在のドライバーのバージョン |
| ドライバー日付 | ドライバーがリリースされた日付 |
| ステータス | デバイスの動作状況（OK/エラー等） |

### 要約情報

プログラムの最後に以下の情報が表示されます：

**問題のあるデバイス要約**
- 問題があるデバイスの一覧
- 各デバイスの問題内容

**デバイス統計**
- デバイスクラス別の数
- ステータス別の数
- 製造元別の数

**推奨事項**
- 具体的な対処方法
- 実行すべき手順

## よくある結果と対処法

### すべて正常な場合

```
=== 問題のあるデバイス要約 ===
すべてのAudioデバイスが正常に動作しています。

=== 推奨事項 ===
現在、特に対応が必要な問題は見つかりませんでした。
```

**対処**: 特に何もする必要はありません。

### 古いドライバーがある場合

```
⚠️ 注意が必要:
  - ドライバーが古い可能性があります（450日前）

🟡 更新推奨: 2個のデバイスのドライバーが古い
```

**対処方法**:
1. Windows Updateを実行
2. デバイスメーカーの公式サイトから最新ドライバーをダウンロード

### デバイスにエラーがある場合

```
🔴 緊急対応が必要: 1個のデバイス
以下の方法で対応してください:
  1. デバイスマネージャーを開く
  2. 問題のあるデバイスを右クリック
  3. 「ドライバーの更新」を選択
  4. 「ドライバーを自動的に検索」でうまくいかない場合、「コンピュータを参照してドライバーを検索」を選択
  5. 「次の場所でドライバーを検索します」の入力欄で C:\Windowsに変更して「次へ」を選択
```

**対処方法**:
1. **Windowsキー + X** を押す
2. **デバイスマネージャー** を選択
3. 黄色い警告マークまたは赤いエラーマークのデバイスを探す
4. 該当デバイスを右クリック
5. **「ドライバーの更新」** を選択
6. **「コンピューターを参照してドライバーを検索」** を選択
7. **「コンピューター上の利用可能なドライバーの一覧から選択」** を選択

## トラブルシューティング

### プログラムが起動しない

**症状**: ダブルクリックしても何も起こらない

**対処法**:
1. コマンドプロンプトから実行してエラーメッセージを確認
2. Windows Defenderやセキュリティソフトが実行をブロックしていないか確認
3. .NET Framework/Runtime が必要な場合はインストール

### 「Audioデバイスが見つかりませんでした」と表示される

**原因**: オーディオドライバーが正しくインストールされていない

**対処法**:
1. デバイスマネージャーを開く
2. 「表示」メニューから「非表示のデバイスの表示」を有効にする
3. 「サウンド、ビデオ、およびゲームコントローラー」を確認
4. 不明なデバイスがあれば右クリックで「ドライバーの更新」

### 文字が正しく表示されない

**症状**: 文字化けや表示の崩れ

**対処法**:
```cmd
# コマンドプロンプトで以下を実行してから起動
chcp 65001
FaraDeviceChecker.exe
```

### 「取得エラー」が表示される

**症状**: 一部のデバイスで「取得エラー: ...」と表示される

**原因**: システムのセキュリティ設定による制限

**対処法**:
- 通常は診断結果に大きな影響はありません
- より詳細な情報が必要な場合は右クリックから「管理者として実行」

## Windows Update の実行方法

ドライバー更新のために Windows Update を実行する手順：

1. **スタートメニュー** を開く
2. **設定** (歯車アイコン) をクリック
3. **Windows Update** を選択
4. **更新プログラムのチェック** をクリック
5. 利用可能な更新があれば **インストール** をクリック
6. 必要に応じて再起動

## 製造元別ドライバーダウンロード先

主要メーカーの公式ドライバーダウンロードページ：

- **Realtek**: [realtek.com](https://www.realtek.com/downloads/)
- **NVIDIA**: [nvidia.com/drivers](https://www.nvidia.com/drivers/)
- **AMD**: [amd.com/support](https://www.amd.com/support/)
- **Intel**: [intel.com/content/www/us/en/support](https://www.intel.com/content/www/us/en/support/)
- **Creative**: [creative.com/support](https://support.creative.com/)

## システム要件

- **OS**: Windows 7 SP1 以降
- **推奨**: Windows 10 以降
- **アーキテクチャ**: x64 (64bit)
- **必要な容量**: 約10MB
- **権限**: 通常のユーザー権限で実行可能

## 注意事項

- このツールはデバイスの状態を確認するのみで、システムに変更を加えません
- 診断結果に基づいてドライバーを更新する際は、事前にシステムの復元ポイントを作成することを推奨します
- 企業環境では、IT管理者に相談してからドライバー更新を行ってください

## サポート

問題や質問がある場合は、[GitHubのIssues](https://github.com/fara1991/FaraDeviceChecker/issues)で報告してください。

報告時に以下の情報を含めると、より迅速にサポートできます：

- Windowsのバージョン（例：Windows 11 22H2）
- プログラムの実行結果（エラーメッセージ等）
- 問題が発生した状況の詳細